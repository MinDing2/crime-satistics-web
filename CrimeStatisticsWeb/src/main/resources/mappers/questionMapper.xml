<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Question">

	<!--  질문 리스트 조회 -->
	<select id="list" resultType ="com.spring.question.vo.QuestionVo">
      SELECT q.question_id
      , q.question_title
      , q.question_content
      , q.create_date
      , m.nickname
      FROM question q
      INNER JOIN member m ON q.memberid = m.memberid
   </select>
   
	<!--  질문 삽입  -->
	<insert id="writeQuestion" >
		insert into question( memberid, question_title, question_content)
		values(#{ memberid }, #{ question_title }, #{ question_content })
	</insert>
	
	<!--  질문 조회 -->
	<select id="view" parameterType="int" resultType="com.spring.question.vo.QuestionVo">
	SELECT
      question_id
    , question_title
    , question_content
    , m.nickname
    , create_date
	FROM
    	question q
	INNER JOIN 
   		 MEMBER m ON q.memberid = m.memberid
	WHERE
    	question_id = #{ question_id }
	</select>
	
	<!-- 질문 수정 -->
	<update id="modify" parameterType="com.spring.question.vo.QuestionVo" >
		update question
   			 set 
       			 question_title   = #{question_title},
        		 question_content = #{question_content}
   			 where question_id    = #{question_id}
	</update>
	
	<!-- 질문 삭제 -->
	<delete id = "delete" parameterType="int">
		delete
			from question
		where question_id = #{question_id}
	</delete>
	
	<!-- 질문 개수 -->
	<select id = "count" resultType = "int">
		select count(question_id) from question;
	</select>
	
	<select id="listpage" parameterType = "hashMap" resultType="com.spring.question.vo.QuestionVo">
		select
			question_id,
			question_title,
			create_date,
			m.nickname
		from question q 
		INNER JOIN 
   		MEMBER m ON q.memberid = m.memberid
		OFFSET #{displayPost}
		ROWS FETCH FIRST #{postNum} ROWS ONLY;
	</select>
</mapper>